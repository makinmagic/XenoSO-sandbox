<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://blogimages6.wordpress.com/wp-content/uploads/2024/10/snd.png" type="image/png"> <!-- Favicon -->
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <title>XenoSO Dashboard</title>
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.6.0/css/all.css">
    <link rel="stylesheet" href="https://site-assets.fontawesome.com/releases/v6.6.0/css/sharp-solid.css">
	<script src="https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js" crossorigin="anonymous"></script>
    <script src="https://makinmagic.github.io/XenoSO-sandbox/functions.js"></script>
    <!--<script src="https://makinmagic.github.io/XenoSO/functions/functions-Christmas.js"></script>-->
	<script src="https://makinmagic.github.io/XenoSO/functions/functions-nye.js"></script>
    <link rel="stylesheet" href="https://mominc.neocities.org/nye.js">
</head>
<body>
   <!-- Stars background - used with permission from Sorta -->
  <div class="stars" id="stars"></div>
    <!-- <div id="dark-mode-toggle" style="position: absolute; top: 20px; right: 20px; cursor: pointer;">
    <i id="darkModeIcon" class="fa-solid fa-moon"></i>
    </div> -->
    <h1>
  <i class="fa-solid fa-tree-christmas"></i>
  <span>XenoSO Dashboard</span>
  <i class="fa-solid fa-tree-christmas"></i>
</h1>
    <div id="tempoSim" style="font-weight: bold;">Time in Xenovia: Loading time...</div>
    <div id="money-object" style="font-weight: bold;">Loading today's top-paying MOs...<a href="#" id="viewAllLink">View All</a></div>
    <div id="countdown" style="text-align: center; font-weight: bold;"></div>
	<p id="event-message" style="display: none; font-weight: bold; font-size: 18px; text-align: center;">Happening now: üîã FREE GREEN üîã at skill lots!</p>
    <div id="currentEvent" style="text-align: center; font-weight: bold;"></div>
    <div id="main-container">
<div class="container">
            <div style="display: flex; align-items: center;">
  <h3 id="players-title" style="flex-grow: 1; text-align: center;">
    <span class="sims-online-icon"></span> Sims Online: 0 <span class="sims-online-icon"></span>
  </h3>
  <i class="fa-solid fa-search search-icon" onclick="toggleSearch('sim')"></i>
  <input type="text" id="sim-search" placeholder="Search any Sim" list="simnames" autocomplete="off" style="display: none; margin-left: 10px;" onkeyup="searchSim(event)"><datalist id="simnames"></datalist>
</div>

<div style="display: flex; align-items: center; justify-content: center; margin-top: 8px; margin-bottom: 12px;">
  <div class="current-job-summary" style="text-align: center; margin: 0;">
  <strong>üíº Current Job: <span id="current-job-label">Loading...</span></strong> |
  <a href="#" class="job-link" onclick="openJobSchedulerModal()">View Schedule</a>
</div>
</div>
	
            <div class="scrollable" id="players"></div>
        </div>
        <div class="container">
            <div style="display: flex; align-items: center;">
    <h3 id="lots-title" style="flex-grow: 1; text-align: center;"><span class="active-lots-icon"></span> Active Lots <span class="active-lots-icon"></span></h3>
    <i class="fa-solid fa-search search-icon" onclick="toggleSearch('lot')"></i>
    <input type="text" id="lot-search" placeholder="Search any Lot" list="lotnames" autocomplete="off" style="display:none; margin-left: 10px;" onkeyup="searchLot(event)"><datalist id="lotnames"></datalist>
</div>
            <div id="lot-filter">
    <i class="fa-solid fa-mug-hot" title="Service" onclick="filterLots('Service')"></i>
    <i class="fa-solid fa-hammer" title="Skills" onclick="filterLots('Skills')"></i>
    <i class="fa-solid fa-dollar-sign" title="Money" onclick="filterLots('Money')"></i>
    <i class="fa-solid fa-handshake" title="Welcome" onclick="filterLots('Welcome')"></i>
    <i class="fa-solid fa-masks-theater" title="Entertainment" onclick="filterLots('Entertainment')"></i>
    <i class="fa-solid fa-gift" title="Store" onclick="filterLots('Store')"></i>
    <i class="fa-solid fa-heart" title="Romance" onclick="filterLots('Romance')"></i>
    <i class="fa-solid fa-house-chimney" title="Residential" onclick="filterLots('Residential')"></i>
    <i class="fa-solid fa-dice-three" title="Games" onclick="filterLots('Games')"></i>
    <i class="fa-solid fa-building" title="Community" onclick="filterLots('Community')"></i>
    <i class="fa-solid fa-arrow-rotate-left" title="Show All" onclick="filterLots('')"></i>
            </div>
            <div class="scrollable" id="lots"></div>
        </div>
    </div>

    <div id="bottom-container" style="display: flex; justify-content: space-between; gap: 1%;">
    <div id="events-container" class="container">
    <h3 style="margin-bottom: 10px; margin-top: 20px; margin-bottom: 5px;"><span class="upcoming-events-icon"></span> Upcoming Events <span class="upcoming-events-icon"></span></h3>
    <div style="text-align: center; margin-top: 5px; margin-bottom: 7px;">
            <a href="https://forms.gle/tTb2EVU98QMQRgvx9" target="_blank" style="text-decoration: underline; font-weight: bold;">
                Click here to add your event!
            </a>
        </div>
        <div class="scrollable">
        <table id="events-table">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Event Name</th>
                    <th>Location</th>
                </tr>
            </thead>
            <tbody>
                <!-- Events will be populated dynamically -->
            </tbody>
        </table>
                </div>
    </div>
    <div id="console-container" class="container">
        <h3><span class="console-icon"></span> Console <span class="console-icon"></span></h3>
        <div id="console-content">
            <p style="text-align: center; color: #black;">Select or search for a Sim or Lot to see more information, or click on an Event to view details.</p>
            <!-- Content for Console will go here -->
        </div>
    </div>
</div>
	<button id="backToTopBtn" title="Back to Top">‚¨ÜÔ∏è</button>
	<div id="guideLink" style="text-align: center; font-weight: bold;">
    <a href="https://xenoso.space/" target="_blank">Main Website</a> |
  <a href="https://xenoso.fandom.com/" target="_blank">Wiki</a> |
<a href="https://makinmagic.github.io/timer/" target="_blank">SMO Timer</a> |
  <a href="https://makinmagic.github.io/pizza/" target="_blank">Pizza Helper</a> |
  <a href="https://makinmagic.github.io/puzzle/" target="_blank">Tomb Puzzle Helper</a> |
	<a href="https://www.somethingmysterious.space/candytimer.html" target="_blank">Candy Clock</a>	
</div>
<div id="footer-note" style="text-align: center; margin-bottom: 0px; font-size: 16px;">
        <i class="fa-regular fa-star"></i> Click on the star next to a Sim or a Lot to favourite them. This will make them show up at the top of the list when they're online!<br><br>
	<i class="fa-regular fa-search"></i> You can search for any Sim or Lot, whether they are online or not!<br><br>
	Add "Level X" to your bio to show your level while you're at work! Use "Join me at" to show a label inviting others! üíº 
	<br><br>
	Made with ‚ù§Ô∏è for XenoSO by Mr Teddy üêª
    </div>
	
<script>
// Initialize the dashboard and set up periodic checks
async function init() {
    // createSnowflakes();
    createFirework();
	launchFireworks();
    tempoSim(); // Start simulation timing
    // fetchMoneyObject(); // Display the money object
    generateStars(); // Starry background - used with permission from Sorta
    await loadCountdown(); // Countdown messages
    await loadTopPayingMOs(); // Top-paying MOs (manual)
    await loadOnlinePlayers(); // Load online players
    await loadLots(); // Load active lots
    fetchEvents(); // Load and display upcoming events
    displayCurrentEvent(); // Initial check for any ongoing event and add balloon icon
    switchJob('factory');
}

function openJobSchedulerModal() {
  document.getElementById("jobSchedulerModal").style.display = "block";
}

function closeJobSchedulerModal() {
  document.getElementById("jobSchedulerModal").style.display = "none";
}

window.onload = () => {

  document.querySelectorAll(".modal .close").forEach(closeBtn => {
    closeBtn.addEventListener("click", () => {
      closeBtn.closest(".modal").style.display = "none";
    });
  });

  // "Back to Top" button
  document.getElementById("backToTopBtn").addEventListener('click', () => {
  window.scrollTo({
    top: 0,
    behavior: 'smooth'
  });
});

  init();
  setInterval(displayCurrentEvent, 60000);
};
	
</script>

<div id="jobSchedulerModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeJobSchedulerModal()">&times;</span>
    <div id="job-scheduler-container">
      <div class="panel">
  <div class="panel-header">
    <span>üíº</span>
    <span>Job Scheduler</span>
  </div>
  <div class="panel-content">
    <div class="job-selector">
      <button id="job-factory" class="job-btn active" onclick="switchJob('factory')">Factory</button>
      <button id="job-restaurant" class="job-btn" onclick="switchJob('restaurant')">Diner</button>
      <button id="job-nightclub" class="job-btn" onclick="switchJob('nightclub')">Club</button>
    </div>
    <div class="job-info">
      <div class="info-row">
        <span>Job:</span>
        <span id="current-job-name" class="time-value">Robot Factory</span>
      </div>
      <div class="info-row">
        <span>Shift Time:</span>
        <span id="current-job-time" class="time-value">9:00 AM</span>
      </div>
      <div class="info-row">
        <span>Next Shift:</span>
        <span id="job-countdown" class="time-value job-countdown">--:--:--</span>
      </div>
	<div class="job-credit">
  <span style="font-style: italic;">Made by and used with permission from Sorta</span> üíú
</div>
    </div>
  </div>
</div>
    </div>
  </div>
</div>
	
<!-- MO Modal -->
<div id="moModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h3 style="margin-top: 15px; margin-bottom: 20px;">All MO Data</h3>

    <div id="moTabs">
      <div class="tab-header">
        <button class="tab-btn active" data-tab="percentTab">üìà By %</button>
        <button class="tab-btn" data-tab="payoutTab">üíµ By Payout</button>
      </div>

      <div class="tab-content" id="percentTab" style="display:block;">
        <div class="mo-bar-wrapper" id="percentBars"></div>
        <p class="mo-note">Updated by Mr Teddy, Miru, and Samaru!</p>
      </div>

      <div class="tab-content" id="payoutTab" style="display:none;">
        <div class="mo-bar-wrapper" id="payoutBars"></div>
        <p class="mo-note">Payouts estimated with max skills and 10+ players on the same SMO</p>
      </div>
    </div>
  </div>
</div>

<!-- Sim Info Modal -->
<div id="sim-modal" class="modal" style="display: none;">
  <div class="modal-content">
    <span class="close" onclick="closeSimModal()">&times;</span>
    <div id="sim-modal-content">Loading...</div>
  </div>
</div>

<!-- Sim Notes Modal -->
<div id="notes-modal" class="modal" style="display:none;">
  <div class="modal-content">
    <span class="close" onclick="closeNotesModal()">&times;</span>
    <div id="notes-modal-content">
      <h3 id="notes-modal-title" style="margin-top:0;">Add/Edit Note</h3>
      <textarea id="notes-textarea" rows="5" style="width:100%; resize:vertical;"></textarea>
      <button id="save-note-btn" style="margin-top:10px;">Save Note</button>
    </div>
  </div>
</div>

<!-- Lot Image Modal -->
<div id="lot-image-modal" class="modal" style="display:none;">
  <div class="modal-content" style="max-width: 600px; text-align:center;">
    <span class="close" onclick="closeLotImageModal()">&times;</span>
    <img id="lot-image-modal-img" src="" alt="Lot Image" style="width:100%; border-radius:6px;">
  </div>
</div>
	
</body>
</html>
